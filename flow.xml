<mxfile host="app.diagrams.net" modified="2025-07-04T06:50:00.000Z"
    agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36"
    etag="YOUR_ETAG_HERE" version="24.6.4" type="diagram">
    <diagram id="oauth_sequence_flow" name="OAuth 2.0 Auth Code Grant Sequence">
        <mxGraphModel dx="1234" dy="789" grid="1" gridSize="10" guides="1" tooltips="1" connect="1"
            arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0"
            shadow="0">
            <root>
                <mxCell id="0" />
                <mxCell id="1" parent="0" />
                <mxCell id="L1" value="Client Application"
                    style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;"
                    vertex="1" parent="1">
                    <mxGeometry x="60" y="80" width="120" height="700" as="geometry" />
                </mxCell>
                <mxCell id="L2" value="User's Browser"
                    style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;"
                    vertex="1" parent="1">
                    <mxGeometry x="240" y="80" width="120" height="700" as="geometry" />
                </mxCell>
                <mxCell id="L3" value="Authorization Server"
                    style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;"
                    vertex="1" parent="1">
                    <mxGeometry x="420" y="80" width="120" height="700" as="geometry" />
                </mxCell>
                <mxCell id="L4" value="User"
                    style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;"
                    vertex="1" parent="1">
                    <mxGeometry x="600" y="80" width="80" height="700" as="geometry" />
                </mxCell>
                <mxCell id="L5" value="Resource Server"
                    style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;"
                    vertex="1" parent="1">
                    <mxGeometry x="760" y="80" width="120" height="700" as="geometry" />
                </mxCell>

                <mxCell id="M1" value="Redirect to AS (Client ID, Scope, Redirect URI)"
                    style="html=1;verticalAlign=bottom;endArrow=block;endFill=0;dashed=0;fontSize=11;"
                    vertex="1" parent="1">
                    <mxGeometry x="120" y="140" width="180" height="10" as="geometry">
                        <mxPoint x="120" y="150" as="sourcePoint" />
                        <mxPoint x="300" y="150" as="targetPoint" />
                    </mxGeometry>
                </mxCell>
                <mxCell id="M2" value="Authorization Request"
                    style="html=1;verticalAlign=bottom;endArrow=block;endFill=0;dashed=0;fontSize=11;"
                    vertex="1" parent="1">
                    <mxGeometry x="300" y="170" width="180" height="10" as="geometry">
                        <mxPoint x="300" y="180" as="sourcePoint" />
                        <mxPoint x="480" y="180" as="targetPoint" />
                    </mxGeometry>
                </mxCell>
                <mxCell id="M3" value="Display Login Page"
                    style="html=1;verticalAlign=bottom;endArrow=block;endFill=0;dashed=0;fontSize=11;"
                    vertex="1" parent="1">
                    <mxGeometry x="500" y="200" width="140" height="10" as="geometry">
                        <mxPoint x="500" y="210" as="sourcePoint" />
                        <mxPoint x="640" y="210" as="targetPoint" />
                    </mxGeometry>
                </mxCell>
                <mxCell id="M4" value="Enter Credentials"
                    style="html=1;verticalAlign=bottom;endArrow=block;endFill=0;dashed=1;fontSize=11;"
                    vertex="1" parent="1">
                    <mxGeometry x="500" y="230" width="140" height="10" as="geometry">
                        <mxPoint x="640" y="240" as="sourcePoint" />
                        <mxPoint x="500" y="240" as="targetPoint" />
                    </mxGeometry>
                </mxCell>
                <mxCell id="M5" value="Display Consent Screen"
                    style="html=1;verticalAlign=bottom;endArrow=block;endFill=0;dashed=0;fontSize=11;"
                    vertex="1" parent="1">
                    <mxGeometry x="500" y="260" width="140" height="10" as="geometry">
                        <mxPoint x="500" y="270" as="sourcePoint" />
                        <mxPoint x="640" y="270" as="targetPoint" />
                    </mxGeometry>
                </mxCell>
                <mxCell id="M6" value="Grant/Deny Consent"
                    style="html=1;verticalAlign=bottom;endArrow=block;endFill=0;dashed=1;fontSize=11;"
                    vertex="1" parent="1">
                    <mxGeometry x="500" y="290" width="140" height="10" as="geometry">
                        <mxPoint x="640" y="300" as="sourcePoint" />
                        <mxPoint x="500" y="300" as="targetPoint" />
                    </mxGeometry>
                </mxCell>

                <mxCell id="AltGroup" value="alt User Grants Consent"
                    style="html=1;whiteSpace=wrap;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;fillColor=#f8cecc;strokeColor=#b85450;dashed=0;"
                    vertex="1" parent="1">
                    <mxGeometry x="50" y="330" width="850" height="390" as="geometry" />
                </mxCell>

                <mxCell id="M7" value="Redirect with Authorization Code"
                    style="html=1;verticalAlign=bottom;endArrow=block;endFill=0;dashed=0;fontSize=11;"
                    vertex="1" parent="AltGroup">
                    <mxGeometry x="450" y="30" width="180" height="10" as="geometry">
                        <mxPoint x="450" y="40" as="sourcePoint" />
                        <mxPoint x="270" y="40" as="targetPoint" />
                    </mxGeometry>
                </mxCell>
                <mxCell id="M8" value="Authorization Code"
                    style="html=1;verticalAlign=bottom;endArrow=block;endFill=0;dashed=0;fontSize=11;"
                    vertex="1" parent="AltGroup">
                    <mxGeometry x="210" y="60" width="180" height="10" as="geometry">
                        <mxPoint x="210" y="70" as="sourcePoint" />
                        <mxPoint x="30" y="70" as="targetPoint" />
                    </mxGeometry>
                </mxCell>
                <mxCell id="M9"
                    value="Exchange Code for Token (Auth Code, Client ID, Client Secret)"
                    style="html=1;verticalAlign=bottom;endArrow=block;endFill=0;dashed=0;fontSize=11;"
                    vertex="1" parent="AltGroup">
                    <mxGeometry x="120" y="100" width="360" height="10" as="geometry">
                        <mxPoint x="120" y="110" as="sourcePoint" />
                        <mxPoint x="480" y="110" as="targetPoint" />
                    </mxGeometry>
                </mxCell>
                <mxCell id="M10" value="Access Token, Refresh Token"
                    style="html=1;verticalAlign=bottom;endArrow=block;endFill=0;dashed=1;fontSize=11;"
                    vertex="1" parent="AltGroup">
                    <mxGeometry x="120" y="130" width="360" height="10" as="geometry">
                        <mxPoint x="480" y="140" as="sourcePoint" />
                        <mxPoint x="120" y="140" as="targetPoint" />
                    </mxGeometry>
                </mxCell>
                <mxCell id="M11" value="Access Protected Resources (with Access Token)"
                    style="html=1;verticalAlign=bottom;endArrow=block;endFill=0;dashed=0;fontSize=11;"
                    vertex="1" parent="AltGroup">
                    <mxGeometry x="120" y="180" width="670" height="10" as="geometry">
                        <mxPoint x="120" y="190" as="sourcePoint" />
                        <mxPoint x="790" y="190" as="targetPoint" />
                    </mxGeometry>
                </mxCell>

                <mxCell id="OptGroup" value="opt Resource Server Validates Token"
                    style="html=1;whiteSpace=wrap;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;fillColor=#fff2cc;strokeColor=#d6b656;dashed=1;"
                    vertex="1" parent="AltGroup">
                    <mxGeometry x="690" y="210" width="160" height="110" as="geometry" />
                </mxCell>
                <mxCell id="M12" value="Validate Access Token"
                    style="html=1;verticalAlign=bottom;endArrow=block;endFill=0;dashed=0;fontSize=11;"
                    vertex="1" parent="OptGroup">
                    <mxGeometry x="10" y="20" width="140" height="10" as="geometry">
                        <mxPoint x="10" y="30" as="sourcePoint" />
                        <mxPoint x="150" y="30" as="targetPoint" />
                    </mxGeometry>
                </mxCell>
                <mxCell id="M13" value="Validation Result"
                    style="html=1;verticalAlign=bottom;endArrow=block;endFill=0;dashed=1;fontSize=11;"
                    vertex="1" parent="OptGroup">
                    <mxGeometry x="10" y="50" width="140" height="10" as="geometry">
                        <mxPoint x="150" y="60" as="sourcePoint" />
                        <mxPoint x="10" y="60" as="targetPoint" />
                    </mxGeometry>
                </mxCell>
                <mxCell id="M14" value="Protected Resources"
                    style="html=1;verticalAlign=bottom;endArrow=block;endFill=0;dashed=1;fontSize=11;"
                    vertex="1" parent="AltGroup">
                    <mxGeometry x="120" y="340" width="670" height="10" as="geometry">
                        <mxPoint x="790" y="350" as="sourcePoint" />
                        <mxPoint x="120" y="350" as="targetPoint" />
                    </mxGeometry>
                </mxCell>
                <mxCell id="ElseGroup" value="else User Denies Consent"
                    style="html=1;whiteSpace=wrap;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;fillColor=#e1d5e7;strokeColor=#9673a6;dashed=0;"
                    vertex="1" parent="1">
                    <mxGeometry x="50" y="730" width="850" height="100" as="geometry" />
                </mxCell>
                <mxCell id="M15" value="Redirect with Error"
                    style="html=1;verticalAlign=bottom;endArrow=block;endFill=0;dashed=0;fontSize=11;"
                    vertex="1" parent="ElseGroup">
                    <mxGeometry x="450" y="20" width="180" height="10" as="geometry">
                        <mxPoint x="450" y="30" as="sourcePoint" />
                        <mxPoint x="270" y="30" as="targetPoint" />
                    </mxGeometry>
                </mxCell>
                <mxCell id="M16" value="Error"
                    style="html=1;verticalAlign=bottom;endArrow=block;endFill=0;dashed=1;fontSize=11;"
                    vertex="1" parent="ElseGroup">
                    <mxGeometry x="210" y="50" width="180" height="10" as="geometry">
                        <mxPoint x="270" y="60" as="sourcePoint" />
              <mxPoint x="90" y="60"
                            as="targetPoint" />  </mxGeometry>
                </mxCell>

            </root>
        </mxGraphModel>
    </diagram>
  </mxfile>